@{
    ViewBag.Title = "Alfemo";
    Layout = "~/Areas/Management/Views/Shared/_Layout.cshtml";
}

<link href="~/Content/shipment.css" rel="stylesheet" />
<style>
    #toggleSwitch {
        width: 38px;
        height: 24px;
        appearance: none;
        background: #ccc;
        border-radius: 15px;
        position: relative;
        outline: none;
        cursor: pointer;
    }

        #toggleSwitch:checked {
            background: #c3d08b;
        }

        #toggleSwitch:before {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            background: #fff;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: 0.3s;
        }

        #toggleSwitch:checked:before {
            left: 16px;
        }
</style>

<div id="jCrumbs" class="breadCrumb module">
    <ul>
        <li>
            <a href="/management">
                <i class="glyphicon glyphicon-home"></i>
            </a>
        </li>
        <li style="background: none;">
            <span style="width: 50px;"><a href="#" style="width: 83px;">İşlemler</a></span>
            <div class="chevronOverlay" style="display: block;"></div>
        </li>
        <li>
            Kullanıcılar
        </li>
    </ul>
</div>

<div class="col-sm-12 col-md-12 border-filter">
    <div class="col-sm-6">
        <form class="form-inline" style="margin-bottom:14px">
            <div class="form-group">
                <label class="col-form-label" style="padding-left: 8px;">Durumu :</label>
            </div>

            <div class="form-group">
                <select id="drpUserState" class="form-control js-example-basic-single" style="width:100%;">
                    <option value="AKTIF">AKTIF</option>
                    <option value="PASIF">PASIF</option>
                    <option value="TUMU">TUMU</option>
                </select>
            </div>

            <div class="form-group margin-left-15">
                <a id="btn-execute"
                   class="btn btn-default form-control icon-text-button hint--top hint--rounded"
                   data-hint="Yürüt">
                    <img src="~/img/realtime_25.png" />
                </a>
            </div>

            @*<div class="form-group">
                    <a id="download-xlsx"
                       class="btn btn-default form-control icon-text-button hint--top hint--rounded"
                       data-hint="Excele Aktar"
                       href="#">
                        <img src="~/img/mexcel_25.png" />
                    </a>
                </div>*@
        </form>
    </div>
</div>

<div class="col-sm-12 col-md-12 margin-top-5 padding-left-0 padding-right-0">
    <table class="table table-striped table-bordered display nowrap padding-left-0 padding-right-0"
           id="tblUser" style="width:100%">
        <thead>
            <tr>
                <th class="center">ID</th>
                <th class="center">Adı Soyadı</th>
                <th class="center">Kullanıcı Adı</th>
                <th class="center">Telefon</th>
                <th class="center">Rol</th>
                <th class="center">İşlem</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
</div>

<div id="freezeOverlay"></div>

@section Scripts{
    <script src="~/Scripts/select2.min.4.0.10.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript">
        $(function () {
            $('#drpUserState').select2({
                placeholder: 'Seçiniz',
                allowClear: true
            });

            $('#freezeOverlay').hide();

            var table = $("#tblUser").DataTable({
                language: {
                    url: "@Url.Content("~/Content/tr.json")",
                    processing: '<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i><span class="sr-only">Loading...</span>'
                },
                processing: true,
                scrollX: true,
                fixedHeader: true,
                autoWidth: true,
                responsive: true,
                retrieve: true,
                displayLength: 15,
                ajax: null,
                columns: [
                    { data: 'ID', visible: false },
                    { data: 'NameSurname' },
                    { data: 'RegistrationNo' },
                    { data: 'Phone1' },
                    { data: 'Role' },
                    {
                        "mData": null,
                        "bSortable": false,
                        "mRender": function (data, type) {
                            return '<a href="/Document/GetMontagePdf?matnr=' + data.MATNR + '" class="btn btn-trash btn-grid">' +
                                '<i class="fa fa-trash btn-middle-icon"></i>' +
                                '</a>' +
                                ' <a href="/Document/GetMontagePdf?matnr=' + data.MATNR + '" class="btn btn-edit btn-grid">' +
                                '<i class="fa fa-edit btn-middle-icon"></i>' +
                                '</a> ' +
                                '<input type="checkbox" id="toggleSwitch" class="btn-toggle"><span id="switchLabel"></span>';
                        }
                    }
                ],
                columnDefs: [
                    { width: "10%", targets: [5] },
                    { className: 'dt-center', targets: [0,1,2,3,4,5] }
                ]
            }).on('xhr', function (e, settings, json, xhr) {
                $('#freezeOverlay').hide();
            });

            $("#btn-execute").click(function () {
                table.clear().draw();
                disableElements();
                var customer = JSON.parse(sessionStorage.getItem("Customer"));
                table.ajax.url('/User/GetData?cID=' + customer.ID).load();
            });

            function disableElements() {
                $("#btn-execute").prop("disabled", true);
                $('#freezeOverlay').show();
            }
        });
    </script>
}

